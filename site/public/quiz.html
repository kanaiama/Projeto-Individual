<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poonda! Quiz</title>

    <link rel="stylesheet" href="css/sobremim.css">
    <link rel="stylesheet" href="css/quiz.css">
    <link href="https://fonts.googleapis.com/css2?family=Jomhuria&display=swap')" rel="stylesheet">
</head>

<body>

    <!--HEADER INICIO-->
    <div class="header">
        <div class="logo">
            <img src="assets/imgs/logoYinYang.png">
            <a href="index.html">
                <p>
                    Poonda!
                </p>
            </a>
        </div>
        <div class="container">
            <ul class="navbar">
                <li>
                    <a href="sobremim.html">Sobre o Criador</a>
                </li>
                <li>
                    <a href="quiz.html">Quiz</a>
                </li>
                <li id="login">
                    <a href="login.html">Login</a>
                </li>
                <li id="cadastro">
                    <a href="cadastro.html">Cadastro</a>
                </li>
                <li id="sai" style="display: none;">
                    <a onclick="sair()" href="login.html">Sair</a>
                </li>
            </ul>
        </div>
    </div>
    <!-- FIM DO HEADER -->

    <!-- BANNER -->

    <div id="div_sumir">
        <div class="banner">
            <div class="div_background_quizBV">
                <div class="container_quiz" id="container_quiz" style="display: flex;">
                    <p class="texto_quiz_bem_vindo">Bem-Vindo ao Quiz de personalidade de Kung fu Panda!</p>
                    <p class="texto_quiz_qual_vilao">Descubra qual vilão de Kung fu Panda você seria!</p>
                    <button onclick="btn_inicio_quiz()" class="btn_iniciar_quiz">INICIAR QUIZ</button>
                </div>

                <div class="quiz1" id="quiz1" style="display: none;">
                    <div class="caixa_pergunta_q1">
                        <span>
                            QUAL VILÃO VOCÊ PREFERE OU SE IDENTIFICA MAIS?
                        </span>
                    </div>
                    <div class="caixa_resposta_q1">
                        <ul>
                            <li>
                                <img src="assets/imgs/img-icon/iconTai.png" onclick="quiz(1)">
                            </li>
                            <li>
                                <img src="assets/imgs/img-icon/iconShen.png" onclick="quiz(2)">
                            </li>
                            <li>
                                <img src="assets/imgs/img-icon/iconKai.png" onclick="quiz(3)">
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="quiz2" id="quiz2" style="display: none;">
                    <div class="caixa_pergunta_q2">
                        <span>
                            QUAL DESSES SENTIMENTOS ESTEVE MAIS FREQUENTE EM SUA VIDA?
                        </span>
                    </div>
                    <div class="botoes_q2">
                        <ul>
                            <li>
                                <button onclick="quiz(1)" class="raiva">Raiva</button>
                            </li>
                            <li>
                                <button onclick="quiz(4)" class="ganancia">Ganância</button>
                            </li>
                            <li>
                                <button onclick="quiz(2)" class="frustracao">Frustração</button>
                            </li>
                            <li>
                                <button onclick="quiz(3)" class="inveja">Inveja</button>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="quiz3" id="quiz3" style="display: none;">
                    <div class="caixa_pergunta_q3">
                        <span>
                            QUAL DESSAS FRASES DO OOGWAY VOCÊ PREFERE?
                        </span>
                    </div>
                    <div class="botoes_q3">
                        <ul>
                            <li>
                                <button onclick="quiz(2)" class="btn_primeira_q3">
                                    “Aquele que foge do seu destino acaba indo de encontro a ele…”
                                </button>
                            </li>
                            <li>
                                <button onclick="quiz(3)" class="btn_segunda_q3">
                                    “Quanto mais você toma, menos você tem”
                                </button>
                            </li>
                            <li>
                                <button onclick="quiz(1)" class="btn_terceira_q3">
                                    “Se o caminho que percorrerem leva vocês sempre de volta a si mesmos, então não irão
                                    a lugar algum.”
                                </button>
                            </li>
                        </ul>
                    </div>
                </div>


                <div class="quiz4" id="quiz4" style="display: none;">
                    <div class="caixa_q4">
                        <div class="caixa_pergunta_q4">
                            <span>
                                ESCOLHA UMA DAS FRASES A SEGUIR QUE VOCÊ SE IDENTIFICA MAIS.
                            </span>
                        </div>
                    </div>

                    <div class="botoes_q4">
                        <ul>

                            <li>
                                <button onclick="quiz(1)" class="btn_primeira_q4">
                                    “Não aceito mudanças com facilidade"
                                </button>
                            </li>
                            <li>
                                <button onclick="quiz(3)" class="btn_segunda_q4">
                                    “Sou ganancioso, sempre querendo mais”
                                </button>
                            </li>
                            <li>
                                <button onclick="quiz(4)" class="btn_terceira_q4">
                                    "Sou muito orgulhoso"
                                </button>
                            </li>
                            <li>
                                <button onclick="quiz(2)" class="btn_quarta_q4">
                                    “Faria qualquer coisa para alcançar meu objetivo final.”
                                </button>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="quiz5" id="quiz5" style="display: none;">
                    <div class="caixa_q5">
                        <div class="caixa_pergunta_q5">
                            <span>
                                QUAL DESSAS CARACTERÍSTICAS VOCÊ PREZA MAIS?
                            </span>
                        </div>
                    </div>

                    <div class="botoes_q5">
                        <ul>
                            <li>
                                <button onclick="quiz(1)" class="btn_primeira_q5">
                                    Adaptabilidade e agilidade
                                </button>
                            </li>
                            <li>
                                <button onclick="quiz(2)" class="btn_segunda_q5">
                                    Liderança e inteligência
                                </button>
                            </li>
                            <li>
                                <button onclick="quiz(3)" class="btn_terceira_q5">
                                    Força física e espiritualidade
                                </button>
                            </li>
                        </ul>
                    </div>
                </div>


                <div class="quiz6" id="quiz6" style="display: none;">
                    <div class="caixa_q6">
                        <div class="caixa_pergunta_q6">
                            <span>
                                QUAL DESSAS SITUAÇÕES DOERIA MAIS EM VOCÊ?
                            </span>
                        </div>
                    </div>

                    <div class="botoes_q6">
                        <ul>
                            <li>
                                <button onclick="quiz(3), resultado_final()" class="btn_primeira_q6">
                                    Ser traído pelo melhor amigo
                                </button>
                            </li>
                            <li>
                                <button onclick="quiz(2), resultado_final()" class="btn_segunda_q6">
                                    Ser abandonado pela sua família
                                </button>
                            </li>
                            <li>
                                <button onclick="quiz(1), resultado_final()" class="btn_terceira_q6">
                                    Ter seus sonhos arruinados por alguém
                                </button>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- RESULTADO QUIZ  -->

                <div class="resultado_quiz" id="resul" style="display: none;">

                    <div class="resultado_quiz_tai" id="resultado_tai">
                        <div class="fundo_quiz_tai" id="resultado_background">
                            <div class="nome_resultado">
                                <h2 id="nomePersonagem"></h2>
                            </div>
                            <div class="imagem_resultado">
                                <img src="" id="imagemPersonagem">
                            </div>
                            <div class="descricao_resultado">
                                <span id="descricaoPersonagem"></span>
                            </div>
                        </div>
                    </div>

                    <div class="metrica">
                        <div class="metrica_resultado_escolha">
                            <div class="titulo_metrica_resultadoquiz">
                                <span>QUANTIDADE DE PONTOS EM CADA PERSONAGEM</span>
                            </div>
                            <div class="metrica_tai">
                                <img src="assets/imgs/img-quiz/mTai.png" alt="">
                                <span id="metrica_tai">0</span>
                            </div>
                            <div class="metrica_shen">
                                <img src="assets/imgs/img-quiz/mShen.png" alt="">
                                <span id="metrica_shen">0</span>
                            </div>
                            <div class="metrica_kai">
                                <img src="assets/imgs/img-quiz/mKai.png" alt="">
                                <span id="metrica_kai">0</span>
                            </div>
                        </div>
    
                        <div class="metrica_resultado">
                            <div class="titulo_metrica_resultadoquiz">
                                <span>RANKING DO RESULTADO DE CADA PESSOA</span>
                            </div>
                            <div class="metrica_tai2">
                                <img src="assets/imgs/img-quiz/mTai2.png" alt="">
                                <span id="metrica_tai2">0</span>
                            </div>
                            <div class="metrica_shen2">
                                <img src="assets/imgs/img-quiz/mShen2.png" alt="">
                                <span id="metrica_shen2">0</span>
                            </div>
                            <div class="metrica_kai2">
                                <img src="assets/imgs/img-quiz/mKai2.png" alt="">
                                <span id="metrica_kai2">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

</body>

</html>
<script>

    var resultado = [
        /* TAI LUNG */
        {
            id: 1,
            pontos: 0
        },

        /* LORD SHEN */
        {
            id: 2,
            pontos: 0
        },

        /* KAI */
        {
            id: 3,
            pontos: 0
        }
    ]

    function btn_inicio_quiz() {
        container_quiz.style.display = 'none'
        quiz1.style.display = 'flex'
    }


    function quiz(id) {

        if (quiz1.style.display == 'flex') {
            quiz1.style.display = 'none'
            quiz2.style.display = 'flex'
        } else if (quiz2.style.display == 'flex') {
            quiz2.style.display = 'none'
            quiz3.style.display = 'flex'
        } else if (quiz3.style.display == 'flex') {
            quiz3.style.display = 'none'
            quiz4.style.display = 'flex'
        } else if (quiz4.style.display == 'flex') {
            quiz4.style.display = 'none'
            quiz5.style.display = 'flex'
        } else if (quiz5.style.display == 'flex') {
            quiz5.style.display = 'none'
            quiz6.style.display = 'flex'
        } else if (quiz6.style.display == 'flex') {
            quiz6.style.display = 'none'
            resul.style.display = 'flex'
        }

        /*
        1 - Tai Lung 
        2 - Lord Shein
        3 - Kai
        4 - Tudo   
        */

        contador++
        switch (id) {
            case 1:
                resultado[0].pontos += 3
                break;
            case 2:
                resultado[1].pontos += 3
                break;
            case 3:
                resultado[2].pontos += 3
                break;
            default:
                resultado[0].pontos += 3
                resultado[1].pontos += 3
                resultado[2].pontos += 3
                break;
        }
    }

    /* VALIDAÇÃO - QUAL PERSONAGEM O USUARIO TIROU */

    var contador = 0;
    var cont = 0;
    var p = 0;

    function resultado_final() {
        for (var i = 0; i < 3; i++) {
            var resul = resultado[i].pontos
            if (resul > p) {
                cont = resultado[i].id
                p = resultado[i].pontos
            }
        }
        quizResultado();
        registro();
    }


    function quizResultado() {

        if (cont == 1) {
            resultado_background.style.background = "#0B1225"
        } else if (cont == 2) {
            resultado_background.style.background = "#210000"
        } else {
            resultado_background.style.background = "#0E1F1B"
        }

        fetch(`/quiz/quizResultado/${cont}`)
            .then(function (resposta) {
                if (resposta.ok) {
                    resposta.json()
                        .then(function (resultados) {
                            nomePersonagem.innerHTML = `${resultados[0].nome}`;
                            imagemPersonagem.src = `${resultados[0].imagem}`;
                            descricaoPersonagem.innerHTML = `${resultados[0].descricao}`;
                            metrica_tai.innerHTML = `${resultado[0].pontos}`;
                            metrica_shen.innerHTML = `${resultado[1].pontos}`;
                            metrica_kai.innerHTML = `${resultado[2].pontos}`;
                        })
                }
            })
    }

    function registro () {
        var usuario = sessionStorage.ID_USUARIO;

        fetch(`/quiz/registro`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                usuario,
                cont
            })
        }).then(function(resposta) {
            if(resposta.ok) {
                ranking();
            }
        })
    }

    function ranking () {
        fetch(`/quiz/ranking`)
        .then((resultado) =>{
            if(resultado.ok) {
                resultado.json().then((dado) =>{
                    metrica_tai2.innerHTML = `${dado[0].Personagem}`;
                    metrica_shen2.innerHTML = `${dado[1].Personagem}`;
                    metrica_kai2.innerHTML = `${dado[2].Personagem}`;
                })
            }
        })
    }
</script>

<script src="./js/funcoes.js"></script>
